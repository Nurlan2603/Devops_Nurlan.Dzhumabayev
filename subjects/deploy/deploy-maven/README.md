# deploy-java-maven

Уверен, что все поступившие на данный курс уже знакомы с языком программирования Java. Просто напомню, что Java
используется в:

- вeb-разработке - самый популярный фреймворк на Java это Spring;
- мобильной разработке - приложения на Android пишутся на Java;
- корпоративных системах - в 90-х и нулевых было разработано множество интерпрайз систем, например продукты Oracle.

Java можно отнести как к компилируемым, так и к интерпретируемым языкам программирования. Код на Java сначала компилируется в байт код, а потом этот байт код интерпретируется на Виртуальной Машине Java (JVM).

Пакетные менеджеры на Java называют _Системой Автоматизации Сборки_, так как они отвечают не только
за зависимости, но еще занимаются сборкой всего проекта, а так же могут включать различные
этапы проверки и валидации кода.

Самые популярные системы автоматизации сборки - это Maven и Gradle.

### Maven

В данном задании разберем сборку проекта Java с помощью Maven. Особенности Maven:

- Maven хорошо работает со сторонними пакетами - зависимости проекта хранятся в локальном репозиторий.
- Maven имеет плагиновую архитектуру, т.е. можно встраивать различные задачи в сборку: компиляция, тестирование, развертывание.

Скрипт сборки Maven хранится в файле `pom.xml` и представляет из себя XML-документ ([пример файла](https://github.com/alem-io/track-devops/blob/master/subjects/deploy/deploy-maven/assets/pom.xml)).

### Полезное

- [Maven in 5 Minutes](https://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)
- [Spring Boot Maven Plugin](https://docs.spring.io/spring-boot/docs/2.1.12.RELEASE/reference/html/build-tool-plugins-maven-plugin.html)

### Задание

1. Вся работа должна выполняться в GitHub Classroom в папке `deploy-maven`.
2. Написать Dockerfile, который:

   - использует за основу образ `ubuntu:18.04`;
   - клонирует репозиторий [App](https://github.com/jusan-singularity/spring-data-rest);
   - устанавливает зависимости: OpenJDK, Maven, и т.д.
   - устанавливает зависимости проекта с помощью Maven.
   - запускает проект в директиве `CMD` или `ENTRYPOINT`.

3. Написать `docker-compose.yml`, который:

   - имеет два сервиса `nginx` и `app`;
   - сервис `app` собирает сборку из текущей директории (прим. `build`);
   - сервис `app` имеет имя контейнера `deploy-maven-app`;
   - сервис `nginx` использует образ `nginx:mainline`.
   - сервис `nginx` перенаправляет запрос с хостового порта 80 на 80 порт контейнера;
   - сервис `nginx` монтирует `deploy-maven.conf` внутрь контейнера.
   - сервис `nginx` зависит от `app`;
   - сервис `nginx` имеет имя контейнера `deploy-maven-nginx`;
   - оба сервиса перезапускаются в случае провала;

4. Создать конфигурационный файл `deploy-maven.conf` для nginx, который:

   - слушает 80 порт;
   - перенаправляет запросы на сервис `app`;

5. Запустить docker-compose.yml и проверить работает ли в браузере [http://localhost/](http://localhost/).
6. Запушить в гит: `Dockerfile`, `docker-compose.yml`, `deploy-maven.conf`.

---

### Ответ

- [Dockerfile](Dockerfile)
- [docker-compose.yml](docker-compose.yml)
- [deploy-maven.conf](deploy-maven.conf)
